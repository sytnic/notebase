# Gitflow

## Picture:

https://drive.google.com/file/d/1u3F4_ZbyMPhZ1Qy_tnhEXNK_1RNUnIMf/view?usp=sharing

---
## Команды help

выдаёт в браузер подробные опции команды
    
    git help command

выдаёт список доступных команд

    git help -a

---
## Частые команды

статус ветки/папки

    git status    

добавление всех(.) файлов в отслеживаемую зону staging area

    git add .			

фиксация(коммит) изменений с сообщением

    git commit -m'Message'		

список веток 

    git branch			
 
создание новой ветки с названием branch2  

    git branch <branch2>		

переход в ветку branch2 
    
    git checkout <branch2>		

удаление ветки myfeature 

    git branch -d <myfeature>	
 
слияние в текущую ветку ветки myfeature

    git merge --no-ff <myfeature>	

опубликование в 'origin'-репозиторий ветки develop

    git push origin <develop>	

посмотреть, что понимается под 'origin'

    git remote show origin		

----------------------------

## Original

https://habr.com/ru/post/106912/

В любой момент времени существует всегда готовая как продакшн ветка master и ветка с последними изменениями develop. Остальные ветки вспомогательные, каждая из них в конечном итоге рано или поздно удаляется.

Разработка дополнительных или неизвестных по стабильности функций ведётся во вспомогательных ветках (feature, release, hotfix). Основная разработка может вестись в develop. - dm.s.

---
### feature branches
---
Могут порождаться от: develop.  
Должны вливаться в: develop.  
Соглашение о наименовании: всё, за исключением master, develop, release-* или hotfix-*.

Когда работа в ветви завершена, последняя вливается обратно в develop (что означает, что функциональность будет добавлена в грядущий релиз) или же удаляется (в случае неудачного эксперимента). Ветки фич (обычно) не добавляются в онлайн-репозиторий.

> создание myfeature из ветки develop:

    $ git checkout -b myfeature develop
        // Из ветки develop 
        // создаём и переключаемся в ветку фичи "myfeature"
    
> после работы:

    $ git checkout develop            
        // переключаемся в develop

    $ git merge --no-ff myfeature
        // присоединяем фичу в девелоп

    $ git branch -d myfeature
        //удаляем ветку фичи

    $ git push origin develop 
        //публикуем обновлённую ветку develop в онлайн

---
### release branches
---
Могут порождаться от: develop.  
Должны вливаться в: develop и master.  
Соглашение о наименовании: release-*.  

Новую ветку релиза надо порождать, когда develop полностью или почти полностью соответствует новому релизу. Ветка develop существует всегда и развивается всегда. Только в тот момент, когда от него отпочковывается ветка релиза, ветке релиза присваивается номер версии. До отпочковывания develop содержит изменения для какого-то очередного «нового релиза».


> Создание ветви релиза (release branch)

    $ git checkout -b release-1.2 develop
        // Из ветки Девелопа 
        // создаём и переключаемся в ветку релиза "release-1.2"

> Если есть изменения, они делаются и фиксируются (коммитятся).

    $ ./bump-version.sh 1.2
        // изменяем какие-то файлы в случае необходимости
        // например, прописываем номер версии в файлах
        //Files modified successfully, version bumped to 1.2.
    $ git commit -a -m "Bumped version number to 1.2"
        // фиксируем (коммитим) изменения в ветке релиза
        //[release-1.2 74d9424] Bumped version number to 1.2
        //1 files changed, 1 insertions(+), 1 deletions(-)

Эта ветвь существует до тех пор, пока этот релиз не будет готов к выпуску. Здесь могут проводиться некоторые изменения и фиксы багов. К этой ветви (а не к develop) добавляются исправления багов. Но добавление крупных новых изменений в эту ветвь строго запрещено. Они всегда должны вливаться в ветвь разработки (develop) и ждать следующего большого релиза.
    
    
> Закрытие ветви релиза

Каждый коммит в master — это по определению новый релиз. Далее, этот коммит в master должен быть помечен тегом, чтобы в дальнейшем можно было легко обратиться к любой существовавшей версии продукта.

    $ git checkout master
        // Switched to branch 'master'
    $ git merge --no-ff release-1.2
        // Присоединяем в мастер ветку релиза
    $ git tag -a 1.2
        // Пометка тегом с аннотацией (-a)

Тут также не забыть запушить релиз в онлайн (это будет отдельная папка-версия в онлайне), а потом удалить локальную ветку релиза, если она уже запушена.

---------
> Ответ на вопрос: как и когда появляются теги у ветки мастер?
    
    - теги объявляются/присоединяются к любой ветке (напр.,master) в произвольное время. Но чтобы это не было глупо, выбирается момент после коммита, пуша, мерджа и т.п. Тег - это произвольная пометка, в сущности ни на что не влияет, кроме личного удобства и возможности потом перемещаться по этим отметкам/тегам.  
    Т.о. пометка(тег) ставится более или менее понятной, например, соответствующе номеру присоединённой(мердженной) версии(релиза).  
    Теги (с номерами версий) в ветке мастер нужны для того, чтобы потом перемещаться (git checkout tags/1.0) по версиям внутри ветки мастер, не скачивая каждую версию (каждую ветку релиза) отдельно.

------------
## Cправка по тегам

    git tag 0.2		        сразу создаст тег под этим словом/числом без аннотации
    git tag -a 4.0	        создаст тег под этим словом/числом <word> с аннотацией
    git tag -a 4.0 -m "Version 4.0"		
                            или такой вариант с сообщением

    git tag --list	    	список тегов
    git tag			        список тегов
    git tag -v <tagname>	посмотреть про конкретный тег
    git help tag
    git tag -d <tagname>	удаляет тег
    git checkout tags/1.0	переключаемся на тег <1.0>, слэш обязательно

    Публикация тегов:

    git push origin <tagname>	пушит этот тег в онлайн
    git push origin --tags		пушит все сохраненные теги в онлайн

------------

> Для вливания изменений (пофиксенных багов) из релиза в develop:

    $ git checkout develop
        //Switched to branch 'develop'
    $ git merge --no-ff release-1.2
        // Merge made by recursive.

При необходимости исправляются конфликты и после этого издаются коммиты.

Ветка релиза больше не нужна:

    $ git branch -d release-1.2
        //Deleted branch release-1.2 (was ff452fe).

----------
> ответ на вопрос: как появляются папки релизов/версий в онлайн в гите?

    - они появляются, когда ты пушишь данную ветку в онлайн. название ветки будет отображаться в гит-онлайн отдельной папочкой.  
    Аналогично ветка master или develop постоянно коммититься локально и пушится в онлайн, релизы же(версии) обычно не обновляются долго и удаляются локально, они являются временными ветками, поэтому они один раз выкладываются, сохраняются со своим названием в онлайне и так и сохраняются, локально удаляются. Новые версии - это будут новые временные ветки.


---
### hotfix branches
---

Могут порождаться от: master.  
Должны вливаться в: develop и master.  
Соглашение о наименовании: hotfix-*.  

> Создание ветви исправлений (hotfix branch)

    $ git checkout -b hotfix-1.2.1 master
        // Из мастера создаём и переключаемся в новую ветку Фикса
    $ ./bump-version.sh 1.2.1
        // Проделываем различные изменения
    $ git commit -a -m "Bumped version number to 1.2.1"
        // Фиксируем (коммитим) изменения
        // 1 files changed, 1 insertions(+), 1 deletions(-)

Коммитов может быть несколько.

> Закрытие ветви исправлений

    $ git checkout master
        //Switched to branch 'master'
    $ git merge --no-ff hotfix-1.2.1
        //Merge made by recursive.
        //(Отчёт об изменениях)
    $ git tag -a 1.2.1

    $ git checkout develop
        //Switched to branch 'develop'
    $ git merge --no-ff hotfix-1.2.1
        //Merge made by recursive.
        //(Отчёт об изменениях)

Если в данный момент существует ветвь релиза (release branch), то ветвь исправления (hotfix branch) должна вливаться в неё, а не в ветвь разработки (develop).

> И наконец, удаляем временную ветвь:

    $ git branch -d hotfix-1.2.1
        //Deleted branch hotfix-1.2.1 (was abbe5d6).

-------------------------